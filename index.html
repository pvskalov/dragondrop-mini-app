<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DragonDrop App</title>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–µ–π -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Font Awesome –¥–ª—è –∏–∫–æ–Ω–æ–∫ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ Inter –æ—Ç Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–ª–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ñ–æ–Ω */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Ç–∫–∏, —á—Ç–æ–±—ã –æ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–ª–æ—Å—å */
        .duck-image {
            max-width: 150px; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Ç–∫–∏ */
            height: auto;
        }
        /* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏ */
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px 0;
            color: #6b7280; /* –°–µ—Ä—ã–π —Ç–µ–∫—Å—Ç */
            font-size: 0.75rem; /* text-xs */
            transition: color 0.2s ease-in-out;
        }
        .bottom-nav-item.active {
            color: #007bff; /* –°–∏–Ω–∏–π –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ */
        }
        .bottom-nav-item i {
            font-size: 1.25rem; /* text-xl */
            margin-bottom: 4px;
        }
        /* –°–∫—Ä—ã—Ç—å –ø–æ–ª–æ—Å—É –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ */
        body::-webkit-scrollbar {
            display: none;
        }
        body {
            -ms-overflow-style: none;  /* –î–ª—è IE –∏ Edge */
            scrollbar-width: none;  /* –î–ª—è Firefox */
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .message-box.show {
            opacity: 1;
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ */
        .size-button {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #e5e7eb; /* gray-200 */
            background-color: #f9fafb; /* gray-50 */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .size-button.selected {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            border-color: #3b82f6;
        }
        .size-button:hover:not(.selected) {
            background-color: #e5e7eb; /* gray-200 */
        }
    </style>
    <!-- Firebase SDKs -->
    <script type="module">
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–µ —á–∞—Å—Ç–∏ Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Firebase, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ
        window.firebaseApp = null; // –°–∞–º–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Firebase
        window.db = null;           // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Firestore
        window.auth = null;         // –ú–æ–¥—É–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        window.currentUserId = null; // ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        window.isFirebaseReady = false; // –§–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Firebase

        // –¢–í–û–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE, –ö–û–¢–û–†–£–Æ –¢–´ –°–ö–û–ü–ò–†–û–í–ê–õ –ò–ó –ö–û–ù–°–û–õ–ò FIREBASE
        const firebaseConfig = {
          apiKey: "AIzaSyAs32uOlV5VugkioYbT-PvS-D0L-5IF_mE",
          authDomain: "dragondropapp-9e6a6.firebaseapp.com",
          projectId: "dragondropapp-9e6a6",
          storageBucket: "dragondropapp-9e6a6.firebasestorage.app",
          messagingSenderId: "106217738831",
          appId: "1:106217738831:web:be1b6433b3eae44ce0d03a"
        };

        // –¢–í–û–ô APP_ID –ò–ó –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò –í–´–®–ï
        const appId = "1:106217738831:web:be1b6433b3eae44ce0d03a";


        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function initFirebase() {
            try {
                window.firebaseApp = initializeApp(firebaseConfig); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Firebase
                window.db = getFirestore(window.firebaseApp);       // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö Firestore
                window.auth = getAuth(window.firebaseApp);           // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

                // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç/–≤—ã—Ö–æ–¥–∏—Ç)
                onAuthStateChanged(window.auth, async (user) => {
                    if (user) {
                        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É
                        window.currentUserId = user.uid; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
                        console.log("Firebase: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É. UID:", user.uid);
                    } else {
                        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—à–µ–ª –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –µ—â–µ –Ω–µ –≤–æ—à–µ–ª
                        console.log("Firebase: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É.");
                        // –ï—Å–ª–∏ –Ω–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –æ—Ç Telegram, –≤—Ö–æ–¥–∏–º –∞–Ω–æ–Ω–∏–º–Ω–æ
                        if (!window.__initial_auth_token) {
                            await signInAnonymously(window.auth); // –ê–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥
                            console.log("Firebase: –í—ã–ø–æ–ª–Ω–µ–Ω –∞–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥.");
                        }
                    }
                    window.isFirebaseReady = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ Firebase –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
                    // –ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω,
                    // –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –¥–æ–º–∞—à–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É.
                    // –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
                    // –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É.
                    if (document.readyState === 'loading') { // –ï—Å–ª–∏ DOM –µ—â–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
                        document.addEventListener('DOMContentLoaded', () => renderPage('home'));
                    } else {
                        renderPage('home');
                    }
                });

                // –ï—Å–ª–∏ —Å—Ä–µ–¥–∞ Canvas –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
                if (window.__initial_auth_token) {
                    await signInWithCustomToken(window.auth, window.__initial_auth_token);
                    console.log("Firebase: –í—Ö–æ–¥ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Ç–æ–∫–µ–Ω–æ–º.");
                } else {
                    // –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç, onAuthStateChanged (–≤—ã—à–µ) –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è –æ–± –∞–Ω–æ–Ω–∏–º–Ω–æ–º –≤—Ö–æ–¥–µ
                }

            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase –∏–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:", error);
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –µ—Å–ª–∏ Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è
                showMessage('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
            }
        }

        // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è
        initFirebase();

        // –î–µ–ª–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Firestore –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
        window.firestore = {
            getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, getDocs
        };
    </script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ alert()) -->
    <div id="messageBox" class="message-box"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div id="app-content" class="flex-grow pb-20 overflow-y-auto">
        <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü —Å –ø–æ–º–æ—â—å—é JavaScript -->
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50">
        <div class="flex justify-around h-16 max-w-screen-md mx-auto">
            <button class="bottom-nav-item active" data-page="home">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="bottom-nav-item" data-page="favorites">
                <i class="fas fa-heart"></i>
                <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
            </button>
            <button class="bottom-nav-item" data-page="cart">
                <i class="fas fa-shopping-cart"></i>
                <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
            </button>
            <button class="bottom-nav-item" data-page="friends">
                <i class="fas fa-users"></i>
                <span>–î—Ä—É–∑—å—è</span>
            </button>
            <button class="bottom-nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </button>
        </div>
    </nav>

    <script>
        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –∏ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        let selectedProduct = null;

        // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω—É–∂–Ω–∞ –¥–ª—è calculateCostProductDetails –∏ orderConfirmation
        // –í—ã–Ω–µ—Å–µ–Ω–∞ —Å—é–¥–∞, —á—Ç–æ–±—ã –±—ã–ª–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–æ –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        function calculateFullPrice(basePriceYuan) {
            const yuanToRubRate = 12.5; // –ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫—É—Ä—Å —é–∞–Ω—è –∫ —Ä—É–±–ª—é
            const dragonDropCommissionRate = 0.10; // 10% –∫–æ–º–∏—Å—Å–∏—è DragonDrop
            const fixedCommission = 500; // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è –≤ —Ä—É–±–ª—è—Ö
            const chinaDelivery = 50; // –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ –ö–∏—Ç–∞—é –≤ —é–∞–Ω—è—Ö
            const internationalDeliveryPerKg = 1000; // –ü—Ä–∏–º–µ—Ä–Ω–∞—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –∑–∞ –∫–≥ –≤ —Ä—É–±–ª—è—Ö
            const itemWeightKg = 0.5; // –ü—Ä–∏–º–µ—Ä–Ω—ã–π –≤–µ—Å —Ç–æ–≤–∞—Ä–∞ –≤ –∫–≥

            const priceInRubles = basePriceYuan * yuanToRubRate;
            const commission = Math.max(priceInRubles * dragonDropCommissionRate, fixedCommission);
            const chinaDeliveryRubles = chinaDelivery * yuanToRubRate;
            const internationalDeliveryRubles = internationalDeliveryPerKg * itemWeightKg;
            const russiaDelivery = 300; // –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ –†–æ—Å—Å–∏–∏
            return priceInRubles + commission + chinaDeliveryRubles + internationalDeliveryRubles + russiaDelivery;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        function showMessage(message, duration = 3000) {
            const messageBox = document.getElementById('messageBox');
            messageBox.textContent = message;
            messageBox.classList.add('show');
            // –°–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, duration);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        async function renderPage(pageName) { // –°–¥–µ–ª–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Firebase
            const appContent = document.getElementById('app-content');
            let content = ''; // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è HTML-–∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            let headerTitle = 'DragonDrop'; // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('.bottom-nav-item').forEach(item => {
                if (item.dataset.page === pageName) {
                    item.classList.add('active'); // –î–µ–ª–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º
                } else {
                    item.classList.remove('active'); // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                }
            });

            // –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏–º–µ–Ω–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —Ñ–æ—Ä–º–∏—Ä—É–µ–º –µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            switch (pageName) {
                case 'home':
                    headerTitle = 'DragonDrop';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center space-x-2">
                                    <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm">
                                        <i class="fas fa-times mr-1"></i> –ó–∞–∫—Ä—ã—Ç—å
                                    </button>
                                </div>
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <h1 class="text-xl font-semibold">DragonDrop</h1>
                                <button class="px-4 py-2 bg-blue-500 text-white rounded-full text-sm font-medium">–î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                            <div class="mb-4">
                                <input type="text" placeholder="–ù–∞–π—Ç–∏ –∫—Ä–æ—Å—Å–æ–≤–∫–∏" class="w-full p-3 rounded-xl bg-gray-100 border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <div class="grid grid-cols-2 gap-3 mb-6">
                                <div class="bg-yellow-100 p-3 rounded-xl flex items-center justify-center text-center flex-col shadow-sm">
                                    <img src="https://placehold.co/80x80/FFD700/FFFFFF?text=–î—Ä—É–∑—å—è" alt="–ó–æ–≤–∏ –¥—Ä—É–∑–µ–π" class="rounded-full mb-2">
                                    <p class="text-sm font-medium">–ó–æ–≤–∏ –¥—Ä—É–∑–µ–π! +500‚ÇΩ</p>
                                </div>
                                <div class="bg-purple-100 p-3 rounded-xl flex items-center justify-center text-center flex-col shadow-sm">
                                    <img src="https://placehold.co/80x80/8A2BE2/FFFFFF?text=Dragon" alt="–ß—Ç–æ —É–º–µ–µ—Ç DragonDrop" class="rounded-full mb-2">
                                    <p class="text-sm font-medium">–ß—Ç–æ —É–º–µ–µ—Ç DragonDrop?</p>
                                </div>
                                <div class="bg-gray-100 p-3 rounded-xl flex items-center justify-center text-center flex-col shadow-sm">
                                    <img src="https://placehold.co/80x80/A9A9A9/FFFFFF?text=–ó–∞–∫–∞–∑" alt="3 —Å–ø–æ—Å–æ–±–∞ –∑–∞–∫–∞–∑–∞—Ç—å" class="rounded-full mb-2">
                                    <p class="text-sm font-medium">3 —Å–ø–æ—Å–æ–±–∞ –∑–∞–∫–∞–∑–∞—Ç—å –∫—Ä–æ—Å—Å–æ–≤–∫–∏</p>
                                </div>
                                <div class="bg-red-100 p-3 rounded-xl flex items-center justify-center text-center flex-col shadow-sm">
                                    <img src="https://placehold.co/80x80/FF0000/FFFFFF?text=–°–∫–∏–¥–∫–∞" alt="–ó–∞–∫–∞–∑—ã–≤–∞–π —Å–µ–π—á–∞—Å" class="rounded-full mb-2">
                                    <p class="text-sm font-medium">–ó–∞–∫–∞–∑—ã–≤–∞–π —Å–µ–π—á–∞—Å –ø–ª–∞—Ç–∏ –ø–æ—Ç–æ–º 50%</p>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-3 mb-6">
                                <div class="bg-red-500 text-white p-4 rounded-xl flex flex-col justify-between shadow-md">
                                    <p class="text-sm font-medium">–ë–∞–ª–ª—ã</p>
                                    <p class="text-3xl font-bold">‚ÇΩ 50</p>
                                </div>
                                <div class="bg-blue-500 text-white p-4 rounded-xl flex flex-col justify-between items-end text-right shadow-md">
                                    <p class="text-sm font-medium">–í—ã–±—Ä–∞—Ç—å –∏ –∑–∞–∫–∞–∑–∞—Ç—å</p>
                                    <i class="fas fa-arrow-right text-3xl mt-2"></i>
                                </div>
                            </div>

                            <div class="bg-white p-4 rounded-xl shadow-sm mb-6">
                                <div class="flex items-center justify-between cursor-pointer" onclick="renderPage('calculateCostInfo')">
                                    <div class="flex items-center space-x-3">
                                        <img src="https://placehold.co/40x40/000000/FFFFFF?text=P" alt="Poizon logo" class="rounded-full">
                                        <p class="font-medium">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –∏–∑ Poizon</p>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>

                            <div class="bg-white p-4 rounded-xl shadow-sm mb-6">
                                <div class="flex items-center justify-between">
                                    <h3 class="font-semibold text-lg">–õ—É–∫–±—É–∫ 2025</h3>
                                    <span class="text-blue-500 text-sm cursor-pointer">–í—Å–µ ></span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 mt-4">
                                    <img src="https://placehold.co/100x100/E0BBE4/FFFFFF?text=–û–±—Ä–∞–∑1" alt="–û–±—Ä–∞–∑ 1" class="rounded-lg w-full h-auto object-cover">
                                    <img src="https://placehold.co/100x100/957DAD/FFFFFF?text=–û–±—Ä–∞–∑2" alt="–û–±—Ä–∞–∑ 2" class="rounded-lg w-full h-auto object-cover">
                                    <img src="https://placehold.co/100x100/D291BC/FFFFFF?text=–û–±—Ä–∞–∑3" alt="–û–±—Ä–∞–∑ 3" class="rounded-lg w-full h-auto object-cover">
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'favorites':
                    headerTitle = '–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('home')">
                                    <i class="fas fa-times mr-1"></i> –ó–∞–∫—Ä—ã—Ç—å
                                </button>
                            </div>
                            <div class="flex flex-col items-center justify-center py-10">
                                <img src="https://placehold.co/150x150/FFD700/FFFFFF?text=ü¶Ü" alt="–£—Ç–∫–∞" class="duck-image mb-6">
                                <h2 class="text-2xl font-bold mb-2 text-center">–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
                                <p class="text-gray-600 text-center max-w-xs">–ù–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–∏ —Ä—è–¥–æ–º —Å —Ç–æ–≤–∞—Ä–∞–º–∏, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–æ, —á—Ç–æ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å.</p>
                            </div>
                            <!-- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ -->
                            <div class="mt-8 text-center text-gray-500">
                                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞—à–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã.</p>
                                <p>–î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å –±—ç–∫–µ–Ω–¥–∞.</p>
                            </div>
                        </div>
                    `;
                    break;

                case 'cart':
                    headerTitle = '–ö–æ—Ä–∑–∏–Ω–∞';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('home')">
                                    <i class="fas fa-times mr-1"></i> –ó–∞–∫—Ä—ã—Ç—å
                                </button>
                            </div>
                            <div class="flex flex-col items-center justify-center py-10">
                                <img src="https://placehold.co/150x150/FFD700/FFFFFF?text=ü¶Ü" alt="–£—Ç–∫–∞" class="duck-image mb-6">
                                <h2 class="text-2xl font-bold mb-2 text-center">–ö–æ—Ä–∑–∏–Ω–∞</h2>
                                <p class="text-gray-600 text-center max-w-xs">–í –∫–æ—Ä–∑–∏–Ω–µ –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç. –°–∞–º–æ–µ –≤—Ä–µ–º—è –Ω–∞–ø–æ–ª–Ω–∏—Ç—å –µ–µ!</p>
                            </div>
                            <!-- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
                            <div class="mt-8 text-center text-gray-500">
                                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ç–æ–≤–∞—Ä—ã –≤ –≤–∞—à–µ–π –∫–æ—Ä–∑–∏–Ω–µ.</p>
                                <p>–î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å –±—ç–∫–µ–Ω–¥–∞.</p>
                            </div>
                        </div>
                    `;
                    break;

                case 'friends':
                    headerTitle = '–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('home')">
                                    <i class="fas fa-times mr-1"></i> –ó–∞–∫—Ä—ã—Ç—å
                                </button>
                            </div>
                            <div class="flex flex-col items-center justify-center py-10">
                                <img src="https://placehold.co/150x150/FFD700/FFFFFF?text=ü¶Ü" alt="–£—Ç–∫–∞" class="duck-image mb-6">
                                <h2 class="text-2xl font-bold mb-2 text-center">–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π</h2>
                                <p class="text-gray-600 text-center max-w-xs">–î—Ä—É–≥ –ø–æ–ª—É—á–∏—Ç 500‚ÇΩ —Å—Ä–∞–∑—É, –∞ —Ç—ã –ø–æ–ª—É—á–∏—à—å 500‚ÇΩ, –∫–æ–≥–¥–∞ –¥—Ä—É–≥ —Å–¥–µ–ª–∞–µ—Ç –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑</p>
                            </div>
                            <div class="p-4">
                                <button class="w-full bg-pink-500 text-white py-3 rounded-xl text-lg font-semibold shadow-md">
                                    –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞ 500 ‚ÇΩ
                                </button>
                            </div>
                            <div class="mt-8 text-center text-gray-500">
                                <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.</p>
                                <p>–î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å –±—ç–∫–µ–Ω–¥–∞.</p>
                            </div>
                        </div>
                    `;
                    break;

                case 'settings':
                    headerTitle = '–ù–∞—Å—Ç—Ä–æ–π–∫–∏';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('home')">
                                    <i class="fas fa-times mr-1"></i> –ó–∞–∫—Ä—ã—Ç—å
                                </button>
                            </div>
                            <div class="flex flex-col items-center py-6">
                                <img src="https://placehold.co/100x100/A0D9B1/FFFFFF?text=–ê–Ω–¥—Ä–µ–π" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è" class="w-24 h-24 rounded-full object-cover mb-4 shadow-md">
                                <h2 class="text-2xl font-bold mb-6">Andrey</h2>
                                <p class="text-gray-600 text-sm mb-4">–í–∞—à ID: <span id="display-user-id" class="font-semibold">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                            </div>

                            <div class="space-y-4 mb-6">
                                <div class="flex items-center bg-gray-100 p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-smile text-blue-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å DRAGONDROP —ç–º–æ–¥–∑–∏</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-gray-100 p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-plus-circle text-blue-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>

                            <div class="space-y-4 mb-6">
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-user text-red-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-lock text-gray-600 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-star text-yellow-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–°—Ç–∞—Ç—É—Å</span>
                                    <span class="text-gray-500 mr-2">–ù–æ–≤–∏—á–æ–∫</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-wallet text-green-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ë–∞–ª–∞–Ω—Å</span>
                                    <span class="text-gray-500 mr-2">50 ‚ÇΩ</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-user-plus text-blue-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞</span>
                                    <span class="text-gray-500 mr-2">+500 ‚ÇΩ</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>

                            <div class="space-y-4 mb-6">
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm cursor-pointer" onclick="renderPage('myOrders')">
                                    <i class="fas fa-box text-red-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ó–∞–∫–∞–∑—ã</span>
                                    <span class="text-gray-500 mr-2">1</span> <!-- –≠—Ç–æ –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è -->
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-comment-alt text-orange-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–û—Ç–∑—ã–≤—ã</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-heart text-pink-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-th-large text-purple-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ü–æ–¥–±–æ—Ä–∫–∏</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <div class="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                    <i class="fas fa-eye text-blue-500 mr-3 text-lg"></i>
                                    <span class="flex-grow">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</span>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                            <div class="mt-8 text-center text-gray-500">
                                <p>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å –±—ç–∫–µ–Ω–¥–∞.</p>
                            </div>
                        </div>
                    `;
                    break;

                case 'calculateCostInfo':
                    headerTitle = 'Poizon (De Wu)';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm flex flex-col min-h-[calc(100vh-4rem)]">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('home')">
                                    <i class="fas fa-chevron-left mr-1"></i> –ù–∞–∑–∞–¥
                                </button>
                            </div>
                            <div class="flex items-center mb-6">
                                <img src="https://placehold.co/60x60/000000/FFFFFF?text=ÂæóÁâ©" alt="Poizon logo" class="rounded-lg mr-4">
                                <div>
                                    <h2 class="text-xl font-semibold">Poizon (De Wu)</h2>
                                    <p class="text-gray-600 text-sm">–ö–∏—Ç–∞–π—Å–∫–∏–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –±—Ä–µ–Ω–¥–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤</p>
                                </div>
                            </div>
                            <button class="w-full bg-blue-500 text-white py-2 rounded-xl text-md font-medium mb-8">
                                –û—Ç–∫—Ä—ã—Ç—å –≤ AppStore
                            </button>

                            <h3 class="text-xl font-bold mb-4">–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h3>
                            <p class="text-gray-700 mb-4">
                                –†–∞—Å—Å—á–∏—Ç–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞ –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ Poizon, –≤–∫–ª—é—á–∞—è –Ω–∞—à—É –∫–æ–º–∏—Å—Å–∏—é –∏ –¥–æ—Å—Ç–∞–≤–∫—É.
                            </p>
                            <p class="text-gray-700 mb-4">
                                –ï—Å–ª–∏ —É —Ç–µ–±—è –µ—â–µ –Ω–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Poizon ‚Äî —Å–∫–∞—á–∏–≤–∞–π –ø–æ –∫–Ω–æ–ø–∫–µ –≤—ã—à–µ. –¢–∞–º –µ—Å—Ç—å –ª—é–±—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏ –∏ –≤–µ—â–∏, –¥–µ—à–µ–≤–ª–µ –Ω–∞ 30-50% —á–µ–º –≤ –†–§.
                            </p>
                            <p class="text-gray-700 mb-6">
                                –ê –µ—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—à—å –∑–∞–º–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è ‚Äî —Å–∫–∏–¥—ã–≤–∞–π —Å—Å—ã–ª–∫—É –Ω–∞ Poizon –≤ —á–∞—Ç, –º—ã —Ç–µ–±–µ —Å–∫–∏–Ω–µ–º –≤ –æ—Ç–≤–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä.
                            </p>
                            <a href="#" class="text-blue-500 text-sm mb-auto">–ö–∞–∫ —Å–∫–∞—á–∞—Ç—å –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ Poizon?</a>

                            <button class="w-full bg-blue-500 text-white py-3 rounded-xl text-lg font-semibold shadow-md mt-8" onclick="renderPage('calculateCostInputLink')">
                                –ù–∞—á–∞—Ç—å
                            </button>
                        </div>
                    `;
                    break;

                case 'calculateCostInputLink':
                    headerTitle = '–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä –≤ Poizon';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm flex flex-col min-h-[calc(100vh-4rem)]">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('calculateCostInfo')">
                                    <i class="fas fa-chevron-left mr-1"></i> –ù–∞–∑–∞–¥
                                </button>
                            </div>
                            <p class="text-gray-700 mb-6">
                                –®–∞–≥ 1 –∏–∑ 3: –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç–æ–≤–∞—Ä–µ –≤ Poizon –∫–Ω–æ–ø–∫—É ¬´–ø–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞. <a href="#" class="text-blue-500">–ê –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å?</a>
                            </p>
                            <div class="flex justify-center mb-8">
                                <img src="https://placehold.co/250x150/E0BBE4/FFFFFF?text=–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è" alt="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—é —Å—Å—ã–ª–∫–∏" class="rounded-lg shadow-md">
                            </div>
                            <div class="mb-auto">
                                <input type="url" id="poizon-link-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä Poizon" class="w-full p-3 rounded-xl bg-gray-100 border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <button id="next-step-btn" class="w-full bg-blue-500 text-white py-3 rounded-xl text-lg font-semibold shadow-md mt-8">
                                –î–∞–ª–µ–µ
                            </button>
                        </div>
                    `;
                    break;

                case 'calculateCostProductDetails':
                    headerTitle = '–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏';
                    // –ó–¥–µ—Å—å –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ selectedProduct
                    const product = selectedProduct;
                    if (!product) {
                        // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —à–∞–≥ –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                        showMessage('–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                        renderPage('calculateCostInputLink');
                        return;
                    }

                    // –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
                    // –§—É–Ω–∫—Ü–∏—é calculateFullPrice —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤—ã—à–µ
                    const price29_35 = calculateFullPrice(product.priceYuan); // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
                    const price17_21 = calculateFullPrice(product.priceYuan + 100); // –ü—Ä–∏–º–µ—Ä: —É—Å–∫–æ—Ä–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –¥–æ—Ä–æ–∂–µ –Ω–∞ 100 —é–∞–Ω–µ–π

                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm flex flex-col min-h-[calc(100vh-4rem)]">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('calculateCostInputLink')">
                                    <i class="fas fa-chevron-left mr-1"></i> –ù–∞–∑–∞–¥
                                </button>
                            </div>
                            <div class="flex flex-col items-center mb-6">
                                <img src="${product.imageUrl}" alt="${product.name}" class="w-full max-w-xs rounded-lg shadow-md mb-4">
                                <p class="text-sm text-green-600 font-semibold mb-2"><i class="fas fa-check-circle mr-1"></i> –û—Ä–∏–≥–∏–Ω–∞–ª</p>
                                <h2 class="text-xl font-bold text-center mb-2">${product.name}</h2>
                                <div class="flex flex-wrap justify-center gap-2 text-sm text-gray-600 mb-4">
                                    <span class="bg-gray-100 px-2 py-1 rounded-full">–û–±—É–≤—å</span>
                                    <span class="bg-gray-100 px-2 py-1 rounded-full">–û–±—É–≤—å –¥–ª—è —Å–ø–æ—Ä—Ç–∞</span>
                                    <span class="bg-gray-100 px-2 py-1 rounded-full">–ë–µ–≥</span>
                                </div>
                                <div class="grid grid-cols-2 gap-4 w-full max-w-xs mb-6">
                                    <div class="text-center">
                                        <p class="text-gray-500 text-sm">–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</p>
                                        <p class="font-medium">–ê–º–æ—Ä—Ç–∏–∑–∏—Ä—É—é—â–∏–µ, –∏–∑–Ω–æ—Å–æ—Å—Ç–æ–π–∫–∏–µ</p>
                                    </div>
                                    <div class="text-center">
                                        <p class="text-gray-500 text-sm">–ü–æ—Å–∞–¥–∫–∞</p>
                                        <p class="font-medium">–£–Ω–∏—Å–µ–∫—Å</p>
                                    </div>
                                    <div class="col-span-2 text-center">
                                        <p class="text-gray-500 text-sm">–°–µ–∑–æ–Ω</p>
                                        <p class="font-medium">–í–µ—Å–Ω–∞, –ª–µ—Ç–æ, –æ—Å–µ–Ω—å</p>
                                    </div>
                                </div>

                                <div class="w-full max-w-xs mb-6">
                                    <p class="text-gray-700 text-sm font-bold mb-2">EU</p>
                                    <div id="size-selection" class="flex flex-wrap gap-2">
                                        <!-- –ö–Ω–æ–ø–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã JavaScript'–æ–º -->
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-4 w-full max-w-xs mb-6">
                                    <div class="bg-blue-100 p-3 rounded-xl text-center">
                                        <p class="text-xl font-bold text-blue-700">${price29_35.toFixed(0)} ‚ÇΩ</p>
                                        <p class="text-sm text-blue-600">29-35 –¥–Ω–µ–π</p>
                                    </div>
                                    <div class="bg-blue-100 p-3 rounded-xl text-center">
                                        <p class="text-xl font-bold text-blue-700">${price17_21.toFixed(0)} ‚ÇΩ</p>
                                        <p class="text-sm text-blue-600">17-21 –¥–µ–Ω—å</p>
                                    </div>
                                </div>

                                <p class="text-gray-600 text-sm text-center mb-4">
                                    –≠—Ç–æ—Ç —Ç–æ–≤–∞—Ä –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å, –µ—Å–ª–∏ –æ–Ω –≤–∞–º –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç. <a href="#" class="text-blue-500">–ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–≤–∞—Ä?</a>
                                </p>
                                <p class="text-gray-600 text-sm text-center mb-6">
                                    –°—Ä–æ–∫ —É–∫–∞–∑–∞–Ω –¥–ª—è –ú–æ—Å–∫–≤—ã, –ø–æ –†–æ—Å—Å–∏–∏ ‚Äî –¥–æ–ª—å—à–µ
                                </p>
                            </div>
                            <button id="buy-button" class="w-full bg-blue-500 text-white py-3 rounded-xl text-lg font-semibold shadow-md mt-auto">
                                –ö—É–ø–∏—Ç—å ${price29_35.toFixed(0)} ‚ÇΩ
                            </button>
                        </div>
                    `;
                    break;

                case 'orderConfirmation':
                    headerTitle = '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞';
                    const orderProduct = selectedProduct;
                    if (!orderProduct) {
                        showMessage('–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–µ –¥–ª—è –∑–∞–∫–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.');
                        renderPage('home');
                        return;
                    }

                    // –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (–ø–æ–≤—Ç–æ—Ä–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å)
                    const orderPrice = calculateFullPrice(orderProduct.priceYuan); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ calculateCostProductDetails

                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm flex flex-col min-h-[calc(100vh-4rem)]">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('calculateCostProductDetails')">
                                    <i class="fas fa-chevron-left mr-1"></i> –ù–∞–∑–∞–¥
                                </button>
                            </div>
                            <div class="flex items-center mb-6">
                                <img src="${orderProduct.imageUrl}" alt="${orderProduct.name}" class="w-24 h-24 rounded-lg mr-4 shadow-md">
                                <div>
                                    <h2 class="text-lg font-bold">${orderProduct.name}</h2>
                                    <p class="text-sm text-green-600 font-semibold"><i class="fas fa-check-circle mr-1"></i> –û—Ä–∏–≥–∏–Ω–∞–ª</p>
                                    <p class="text-gray-600 text-sm">–†–∞–∑–º–µ—Ä: EU ${orderProduct.selectedSize}</p>
                                </div>
                            </div>

                            <div class="w-full mb-6">
                                <p class="text-gray-700 text-sm font-bold mb-2">EU</p>
                                <div class="flex flex-wrap gap-2">
                                    <!-- –ö–Ω–æ–ø–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤, –∫–∞–∫ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –Ω–æ —É–∂–µ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º -->
                                    ${orderProduct.availableSizes.map(size => `
                                        <button class="size-button ${size === orderProduct.selectedSize ? 'selected' : ''}" data-size="${size}">
                                            ${size}
                                        </button>
                                    `).join('')}
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-4 w-full mb-6">
                                <div class="bg-blue-100 p-3 rounded-xl text-center">
                                    <p class="text-xl font-bold text-blue-700">${orderPrice.toFixed(0)} ‚ÇΩ</p>
                                    <p class="text-sm text-blue-600">29-35 –¥–Ω–µ–π</p>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-xl text-center">
                                    <p class="text-xl font-bold text-blue-700">${(orderPrice + 1000).toFixed(0)} ‚ÇΩ</p> <!-- –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–π -->
                                    <p class="text-sm text-blue-600">17-21 –¥–µ–Ω—å</p>
                                </div>
                            </div>

                            <h3 class="text-lg font-bold mb-3">–ö–∞–∫ –ø–æ–ª—É—á–∞—Ç—å</h3>
                            <div class="flex bg-gray-100 rounded-xl p-1 mb-4">
                                <button class="flex-1 py-2 rounded-lg bg-white shadow-sm font-medium">–í –º–∞–≥–∞–∑–∏–Ω–µ</button>
                                <button class="flex-1 py-2 rounded-lg font-medium">–í –ø—É–Ω–∫—Ç–µ –≤—ã–¥–∞—á–∏</button>
                                <button class="flex-1 py-2 rounded-lg font-medium">–ö—É—Ä—å–µ—Ä–æ–º</button>
                            </div>
                            <p class="text-gray-700 mb-4">–°–µ—Ä–≥–∏–µ–≤ –ü–æ—Å–∞–¥, –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —É–ª, –¥.20</p>

                            <h3 class="text-lg font-bold mb-3">–ö–æ–º—É –≤—ã–¥–∞—Ç—å</h3>
                            <p class="text-gray-700 mb-2">–ê–Ω–¥—Ä–µ–π –ü–∞—Å–∫–∞–ª–æ–≤</p>
                            <p class="text-gray-700 mb-4">+7 (910) 776 11 86</p>

                            <div class="flex justify-between gap-4 mb-6">
                                <button class="flex-1 bg-green-100 text-green-700 py-2 rounded-xl font-semibold">+50 –±–∞–ª–ª–æ–≤ –ù–∞—á–∏—Å–ª–∏—Ç—å</button>
                                <button class="flex-1 bg-red-100 text-red-700 py-2 rounded-xl font-semibold">-50 –±–∞–ª–ª–æ–≤ –°–ø–∏—Å–∞—Ç—å</button>
                            </div>

                            <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl mb-6">
                                <p class="font-medium">–°–ø–ª–∏—Ç: –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–ª–æ–≤–∏–Ω—É —Å–µ–π—á–∞—Å, –ø–æ–ª–æ–≤–∏–Ω—É –ø–æ–∑–∂–µ</p>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" value="" class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                </label>
                            </div>

                            <button id="place-order-btn" class="w-full bg-blue-500 text-white py-3 rounded-xl text-lg font-semibold shadow-md mt-auto">
                                –ó–∞–∫–∞–∑–∞—Ç—å ${orderPrice.toFixed(0)} ‚ÇΩ
                            </button>
                        </div>
                    `;
                    break;

                case 'myOrders':
                    headerTitle = '–ú–æ–∏ –∑–∞–∫–∞–∑—ã';
                    content = `
                        <div class="p-4 bg-white rounded-b-xl shadow-sm flex flex-col min-h-[calc(100vh-4rem)]">
                            <div class="flex items-center justify-between mb-4">
                                <button class="flex items-center px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm" onclick="renderPage('settings')">
                                    <i class="fas fa-chevron-left mr-1"></i> –ù–∞–∑–∞–¥
                                </button>
                            </div>
                            <h2 class="text-2xl font-bold mb-6 text-center">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2>
                            <div id="orders-list" class="space-y-4 mb-auto">
                                <p class="text-center text-gray-500">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>
                            </div>
                            <div class="mt-8 text-center text-gray-500">
                                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–∫–∞–∑—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.</p>
                            </div>
                        </div>
                    `;
                    break;

                default:
                    content = '<div class="p-4 text-center text-gray-500">–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.</div>';
                    break;
            }

            // –í—Å—Ç–∞–≤–ª—è–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
            appContent.innerHTML = content;

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ—Å–ª–µ –∏—Ö —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
            if (pageName === 'settings') {
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –æ–Ω –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
                const displayUserIdElement = document.getElementById('display-user-id');
                if (displayUserIdElement) {
                    if (window.currentUserId) {
                        displayUserIdElement.textContent = window.currentUserId;
                    } else {
                        displayUserIdElement.textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                    }
                }
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–∞–ª–µ–µ" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ calculateCostInputLink
            if (pageName === 'calculateCostInputLink') {
                document.getElementById('next-step-btn').addEventListener('click', () => {
                    const poizonLink = document.getElementById('poizon-link-input').value.trim();
                    // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–∫–∏. –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞/API
                    if (poizonLink.includes('dw4.co/t/A/1sSPQhtQg')) {
                        // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Å—ã–ª–∫–∏
                        selectedProduct = {
                            name: 'New Balance 530 "White Silver Navy"',
                            imageUrl: 'https://placehold.co/300x300/E0E0E0/333333?text=New+Balance+530', // –ó–∞–≥–ª—É—à–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                            priceYuan: 550, // –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö
                            availableSizes: ['36', '37', '37.5', '38', '38.5', '39', '39.5', '40', '40.5', '41', '42'],
                            selectedSize: '37.5' // –†–∞–∑–º–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                        };
                        renderPage('calculateCostProductDetails');
                    } else {
                        showMessage('–ò–∑–≤–∏–Ω–∏—Ç–µ, —Å–µ–π—á–∞—Å –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É: https://dw4.co/t/A/1sSPQhtQg');
                        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –±—ç–∫–µ–Ω–¥—É –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –ª—é–±–æ–π —Å—Å—ã–ª–∫–∏
                    }
                });
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏–∫—É –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ calculateCostProductDetails
            if (pageName === 'calculateCostProductDetails') {
                const sizeSelectionDiv = document.getElementById('size-selection');
                if (sizeSelectionDiv && selectedProduct && selectedProduct.availableSizes) {
                    selectedProduct.availableSizes.forEach(size => {
                        const button = document.createElement('button');
                        button.textContent = size;
                        button.classList.add('size-button');
                        if (size === selectedProduct.selectedSize) {
                            button.classList.add('selected');
                        }
                        button.dataset.size = size;
                        button.addEventListener('click', () => {
                            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                            document.querySelectorAll('.size-button').forEach(btn => btn.classList.remove('selected'));
                            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∫–Ω–æ–ø–∫—É
                            button.classList.add('selected');
                            selectedProduct.selectedSize = size; // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
                            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ—Å—á–µ—Ç —Ü–µ–Ω—ã, –µ—Å–ª–∏ —Ü–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞
                            showMessage(`–í—ã–±—Ä–∞–Ω —Ä–∞–∑–º–µ—Ä: EU ${size}`);
                        });
                        sizeSelectionDiv.appendChild(button);
                    });
                }

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ö—É–ø–∏—Ç—å"
                document.getElementById('buy-button').addEventListener('click', () => {
                    // –ü–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–∫–∞–∑–∞, —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤—ã–±—Ä–∞–Ω —Ä–∞–∑–º–µ—Ä
                    if (selectedProduct && selectedProduct.selectedSize) {
                        renderPage('orderConfirmation');
                    } else {
                        showMessage('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Ç–æ–≤–∞—Ä–∞.');
                    }
                });
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ó–∞–∫–∞–∑–∞—Ç—å" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ orderConfirmation
            if (pageName === 'orderConfirmation') {
                document.getElementById('place-order-btn').addEventListener('click', async () => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Firebase –≥–æ—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
                    if (!window.isFirebaseReady || !window.currentUserId) {
                        showMessage('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ.');
                        return;
                    }

                    try {
                        // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∑–∞–∫–∞–∑–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Firestore
                        const orderData = {
                            userId: window.currentUserId, // ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                            productName: selectedProduct.name,
                            productImageUrl: selectedProduct.imageUrl,
                            selectedSize: selectedProduct.selectedSize,
                            priceYuan: selectedProduct.priceYuan,
                            totalPriceRub: calculateFullPrice(selectedProduct.priceYuan),
                            orderDate: new Date().toISOString(), // –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–∫–∞–∑–∞
                            status: '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ', // –ù–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
                            deliveryMethod: '–í –º–∞–≥–∞–∑–∏–Ω–µ', // –ü–æ–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä
                            deliveryAddress: '–°–µ—Ä–≥–∏–µ–≤ –ü–æ—Å–∞–¥, –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —É–ª, –¥.20',
                            recipientName: '–ê–Ω–¥—Ä–µ–π –ü–∞—Å–∫–∞–ª–æ–≤',
                            recipientPhone: '+7 (910) 776 11 86'
                        };

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é 'orders' –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        // –ü—É—Ç—å –∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏: /artifacts/{appId}/users/{userId}/orders
                        const ordersCollectionRef = window.firestore.collection(
                            window.db,
                            `artifacts/${appId}/users/${window.currentUserId}/orders`
                        );
                        await window.firestore.addDoc(ordersCollectionRef, orderData);

                        showMessage('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
                        console.log('–ó–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω:', orderData);
                        // –û—á–∏—â–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –ø–æ—Å–ª–µ –∑–∞–∫–∞–∑–∞
                        selectedProduct = null;
                        // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–∫–∞–∑–æ–≤
                        setTimeout(() => renderPage('myOrders'), 1500);

                    } catch (error) {
                        showMessage('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –≤ Firestore:', error);
                    }
                });

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –ø–æ–ª—É—á–µ–Ω–∏—è (–ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ)
                document.querySelectorAll('.flex.bg-gray-100.rounded-xl.p-1.mb-4 button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        document.querySelectorAll('.flex.bg-gray-100.rounded-xl.p-1.mb-4 button').forEach(btn => {
                            btn.classList.remove('bg-white', 'shadow-sm');
                        });
                        event.target.classList.add('bg-white', 'shadow-sm');
                        showMessage(`–í—ã–±—Ä–∞–Ω —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è: ${event.target.textContent.trim()}`);
                    });
                });
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–ú–æ–∏ –∑–∞–∫–∞–∑—ã"
            if (pageName === 'myOrders') {
                const ordersListDiv = document.getElementById('orders-list');
                ordersListDiv.innerHTML = '<p class="text-center text-gray-500">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>';

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Firebase –≥–æ—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
                if (!window.isFirebaseReady || !window.currentUserId) {
                    ordersListDiv.innerHTML = '<p class="text-center text-red-500">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–∫–∞–∑—ã. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω.</p>';
                    return;
                }

                // –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—é –∑–∞–∫–∞–∑–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const userOrdersCollectionRef = window.firestore.collection(
                    window.db,
                    `artifacts/${appId}/users/${window.currentUserId}/orders`
                );

                // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                window.firestore.onSnapshot(userOrdersCollectionRef, (snapshot) => {
                    if (snapshot.empty) {
                        ordersListDiv.innerHTML = '<p class="text-center text-gray-500">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤.</p>';
                        return;
                    }

                    ordersListDiv.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
                    snapshot.forEach(doc => {
                        const order = doc.data();
                        const orderId = doc.id; // ID –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∑–∞–∫–∞–∑–∞
                        ordersListDiv.innerHTML += `
                            <div class="bg-white p-4 rounded-xl shadow-sm flex items-center space-x-4">
                                <img src="${order.productImageUrl}" alt="${order.productName}" class="w-20 h-20 rounded-lg object-cover">
                                <div class="flex-grow">
                                    <p class="font-semibold text-lg">${order.productName}</p>
                                    <p class="text-gray-600 text-sm">–†–∞–∑–º–µ—Ä: EU ${order.selectedSize}</p>
                                    <p class="text-gray-600 text-sm">–°—Ç–∞—Ç—É—Å: <span class="font-medium text-blue-600">${order.status}</span></p>
                                    <p class="text-gray-800 font-bold mt-1">${order.totalPriceRub.toFixed(0)} ‚ÇΩ</p>
                                    <p class="text-gray-500 text-xs">–ó–∞–∫–∞–∑ –æ—Ç: ${new Date(order.orderDate).toLocaleDateString('ru-RU')}</p>
                                    <p class="text-gray-500 text-xs">ID –∑–∞–∫–∞–∑–∞: ${orderId}</p>
                                </div>
                            </div>
                        `;
                    });
                }, (error) => {
                    console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤:", error);
                    ordersListDiv.innerHTML = '<p class="text-center text-red-500">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–∫–∞–∑–æ–≤.</p>';
                });
            }
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        document.querySelectorAll('.bottom-nav-item').forEach(button => {
            button.addEventListener('click', () => {
                renderPage(button.dataset.page); // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏ –∫–ª–∏–∫–µ
            });
        });

        // –ò–∑–Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase
        // document.addEventListener('DOMContentLoaded', () => {
        //     renderPage('home');
        // });
    </script>
</body>
</html>
